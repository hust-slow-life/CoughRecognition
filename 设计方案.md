# CoughRecognition 设计方案

> 创建时间：2026-01-21
> 最后更新：2026-01-21
> 状态：草案（待需求确认后更新）

---

## 一、参考产品分析

### 1. Hyfe (hyfe.ai)
| 项目 | 内容 |
|------|------|
| 场景 | 慢性呼吸道疾病患者的咳嗽监测 |
| 方案 | 后台持续监听 → AI 识别咳嗽 → 记录次数/时间/频率 → 生成报告 |
| 技术 | 边缘 AI + 云端分析 |
| 借鉴点 | 后台监听的产品形态、咳嗽计数、趋势图 |

### 2. ResApp (被 Pfizer 收购)
| 项目 | 内容 |
|------|------|
| 场景 | 远程诊断呼吸道疾病（COVID、肺炎、哮喘等） |
| 方案 | 用户对着手机咳嗽 5 次 → AI 分析特征 → 给出疾病风险评估 |
| 技术 | 机器学习分类模型 |
| 借鉴点 | 主动录制分析的交互设计 |

### 3. StethoMe (针对儿童)
| 项目 | 内容 |
|------|------|
| 场景 | 儿童呼吸道疾病家庭监测 |
| 方案 | 配合智能听诊器 → 记录咳嗽/喘息 → AI 辅助判断是否需要就医 |
| 借鉴点 | 儿童场景的 UI 设计、症状关联记录 |

### 4. Sound of Cough (学术项目)
| 项目 | 内容 |
|------|------|
| 场景 | COVID-19 筛查 |
| 方案 | 通过咳嗽声音特征区分不同疾病 |
| 借鉴点 | 开源数据集和模型架构 |

---

## 二、数据集推荐

### 咳嗽检测

| 数据集 | 规模 | 内容 | 链接 |
|--------|------|------|------|
| **COUGHVID** | 20,000+ | 咳嗽录音，标注健康/COVID/症状 | [GitHub](https://github.com/virufy/coughvid) |
| **Coswara** | 2,000+ | 咳嗽、呼吸、语音（印度理工学院） | [GitHub](https://github.com/iiscleap/Coswara-Data) |
| **AudioSet** | 200万+ | Google 大规模音频，含咳嗽标签 | [官网](https://research.google.com/audioset/) |

### 哭泣检测

| 数据集 | 规模 | 内容 | 链接 |
|--------|------|------|------|
| **ESC-50** | 2,000 | 环境声音分类，含婴儿哭声 | [GitHub](https://github.com/karolpiczak/ESC-50) |
| **Donate a Cry** | 1,000+ | 婴儿哭声，标注原因 | [GitHub](https://github.com/gveres/donateacry-corpus) |

### 注意事项
- 现有数据集以成人为主，儿童咳嗽数据较少
- 可能需要后期自己收集和标注儿童数据
- 不同数据集的录音质量和环境差异较大

---

## 三、模型方案选型

### 方案 A：传统机器学习（轻量）

```
音频 → MFCC/Mel特征提取 → SVM/RandomForest → 分类结果
```

| 优点 | 缺点 |
|------|------|
| 模型小（<1MB） | 准确率有上限 |
| 推理快（<10ms） | 特征工程复杂 |
| 易部署到 iOS | 泛化能力较弱 |

**适用**：快速验证、资源受限场景

### 方案 B：CNN + 迁移学习（推荐 MVP）

```
音频 → Mel频谱图 → 预训练CNN → Fine-tune → 分类结果
```

推荐预训练模型：
- **YAMNet**（Google）：521 类音频分类，模型小，适合移动端
- **PANNs**：大规模音频预训练，效果好
- **VGGish**：成熟稳定，社区支持好

| 优点 | 缺点 |
|------|------|
| 准确率较高 | 模型较大（10-50MB） |
| 迁移学习省数据 | 需要 GPU 训练 |
| 社区支持好 | 频谱图转换有开销 |

**适用**：MVP 阶段，平衡效果和部署难度

### 方案 C：端到端深度学习（最优效果）

```
音频波形 → Wav2Vec2/HuBERT → Fine-tune → 分类结果
```

| 优点 | 缺点 |
|------|------|
| 效果最好 | 模型大（>100MB） |
| 端到端学习 | 需要大量数据 |
| 最新技术 | 移动端部署困难 |

**适用**：追求最高准确率，有足够资源

### MVP 建议
**选择方案 B：YAMNet + 迁移学习**
- 在 COUGHVID 数据集上 Fine-tune
- 转换为 Core ML 格式部署到 iOS
- 预计模型大小 10-20MB

---

## 四、iOS 应用架构（草案）

```
┌─────────────────────────────────────────┐
│                iOS App                   │
├─────────────────────────────────────────┤
│  UI Layer (SwiftUI)                     │
│  ├─ MonitorView     后台监控页面         │
│  ├─ RecordView      手动录制页面         │
│  ├─ AnalysisView    分析结果页面         │
│  ├─ HistoryView     历史记录页面         │
│  └─ HealthLogView   健康日志页面         │
├─────────────────────────────────────────┤
│  Business Layer                          │
│  ├─ AudioMonitor    后台音频监控         │
│  ├─ AudioRecorder   录音管理             │
│  ├─ CoughDetector   咳嗽检测引擎         │
│  ├─ CryDetector     哭泣检测引擎         │
│  ├─ CoughClassifier 咳嗽分类引擎         │
│  └─ HealthLogger    健康数据管理         │
├─────────────────────────────────────────┤
│  ML Layer (Core ML)                      │
│  ├─ CoughDetectionModel.mlmodel         │
│  ├─ CryDetectionModel.mlmodel           │
│  └─ CoughClassificationModel.mlmodel    │
├─────────────────────────────────────────┤
│  Data Layer                              │
│  ├─ SwiftData/CoreData  本地数据库       │
│  └─ FileManager         录音文件管理      │
└─────────────────────────────────────────┘
```

---

## 五、技术选型（草案）

| 模块 | 选择 | 原因 |
|------|------|------|
| UI 框架 | SwiftUI | 现代声明式 UI，开发效率高 |
| 音频处理 | AVFoundation | iOS 原生，功能完整 |
| ML 推理 | Core ML | iOS 原生，性能优化好 |
| 音频特征 | Accelerate/vDSP | 高性能 FFT、MFCC 计算 |
| 本地存储 | SwiftData | iOS 17+ 新框架，简洁易用 |
| 最低版本 | iOS 17.0 | 使用最新 API，简化开发 |

---

## 六、开发里程碑（草案）

### Phase 1：基础框架（1 周）
- [ ] 项目初始化
- [ ] 基础 UI 框架搭建
- [ ] 录音功能实现
- [ ] 本地存储设计

### Phase 2：咳嗽检测（2 周）
- [ ] 数据集准备和预处理
- [ ] 模型训练（YAMNet 迁移学习）
- [ ] Core ML 模型转换
- [ ] 检测功能集成

### Phase 3：后台监控（1 周）
- [ ] 后台音频监听
- [ ] 自动片段录制
- [ ] 通知功能

### Phase 4：咳嗽分类（1 周）
- [ ] 分类模型训练
- [ ] 分析结果展示
- [ ] 历史记录功能

### Phase 5：健康日志（1 周）
- [ ] 症状记录功能
- [ ] 数据关联
- [ ] 简单统计

---

## 七、风险和挑战

### 技术风险
1. **儿童数据不足**：现有数据集以成人为主
2. **环境噪音干扰**：家庭环境复杂
3. **后台耗电**：持续监听可能影响电池

### 产品风险
1. **准确率预期**：用户对 AI 准确率预期可能过高
2. **医疗责任**：需要明确免责声明
3. **隐私顾虑**：后续版本需要解决

### 缓解措施
- 收集用户反馈用于模型迭代
- 明确产品定位为"辅助记录"而非"医疗诊断"
- 提供误报标记功能改进模型

---

## 八、待确定事项

- [ ] 确认 MVP 功能范围后更新架构
- [ ] 确认数据集后更新模型方案
- [ ] 确认 UI 设计后更新技术选型
- [ ] 确认开发资源后更新里程碑

---

## 九、更新记录

### 2026-01-21
- 初始版本，整理讨论内容
- 参考产品分析
- 数据集和模型方案初步建议
- 架构和技术选型草案
